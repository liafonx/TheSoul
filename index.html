<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="theme-color" content="#171b24" />
    <meta name="theme-color" content="#171b24" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#171b24" media="(prefers-color-scheme: dark)" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>The Soul</title>
    <link rel="preload" href="immolate.wasm" as="fetch" type="application/wasm" crossorigin="anonymous" />
    <link rel="stylesheet" href="src/ui.css" />
    <link rel="icon" type="image/png" href="images/icon.ico" />
    <script>
      (function initializeLocalePreference() {
        var browserLang = (navigator.language || navigator.userLanguage || "").toLowerCase();
        var fallbackLocale = (browserLang.indexOf("zh") === 0) ? "zh-CN" : "en-US";
        try {
          var saved = localStorage.getItem("balatro.locale");
          window.__BALATRO_LOCALE__ = (saved === "en-US" || saved === "zh-CN") ? saved : fallbackLocale;
        } catch (_err) {
          window.__BALATRO_LOCALE__ = fallbackLocale;
        }
      })();

      (function initializeUiUaMode() {
        var ua = navigator.userAgent || "";
        var isMobileUa = /Android|iPhone|iPad|iPod|Mobile|Windows Phone|HarmonyOS/i.test(ua);
        var supportsBackdrop = false;
        try {
          supportsBackdrop =
            !!(window.CSS &&
              CSS.supports &&
              (CSS.supports("backdrop-filter: blur(1px)") ||
                CSS.supports("-webkit-backdrop-filter: blur(1px)")));
        } catch (_err) {
          supportsBackdrop = false;
        }

        window.__UI_IS_MOBILE_UA__ = isMobileUa;
        window.__UI_SUPPORTS_BACKDROP__ = supportsBackdrop;

        var root = document.documentElement;
        if (!root) return;
        root.classList.add(isMobileUa ? "ua-mobile" : "ua-desktop");
        root.classList.add(isMobileUa || !supportsBackdrop ? "ua-no-blur" : "ua-blur");
      })();

      (function setAssetVersion() {
        var isLocal = /^(localhost|127\.0\.0\.1)$/.test(window.location.hostname);
        var version = isLocal ? String(Date.now()) : "1";
        window.__ASSET_VERSION__ = version;
      })();

      var Immolate = {
        onRuntimeInitialized: function () {
          if (window.instantAnalysis) {
            performAnalysis();
          }
        },
      };
    </script>
    <script src="immolate.js"></script>
    <script src="localization/generated/en-US.game.js"></script>
    <script src="localization/generated/zh-CN.game.js"></script>
    <script src="localization/generated/name-to-key.js"></script>
    <script src="localization/en-US.ui.js"></script>
    <script src="localization/ui-zh-CN.js"></script>
    <script src="localization/i18n.global.js"></script>
    <script src="src/balatro_lists.js"></script>
    <script src="src/ui.state.js" defer></script>
    <script src="src/ui.unlocks.js" defer></script>
    <script src="src/ui.summary.js" defer></script>
    <script src="src/ui.filters.js" defer></script>
    <script src="src/ui.search-integration.js" defer></script>
    <script src="src/ui.floating.js" defer></script>
    <script src="src/ui.analysis.js" defer></script>
    <script src="src/ui.locale.js" defer></script>
    <script src="src/ui.init.js" defer></script>
    <script src="src/UI.js" defer></script>
  </head>
  <body>
    <h1 class="site-title">
      <div id="localeToggleContainer">
        <button id="localeToggleButton" type="button" aria-label="Toggle language">EN</button>
        <button id="emojiLegendButton" type="button" aria-label="Show intro">Intro</button>
      </div>
      <img src="images/icon.ico" alt="The Soul icon" class="site-title-icon" width="48" height="48" />
      <span>The Soul</span>
    </h1>
    <div class="container">
      <div class="input-section">
        <h2>Config Analyze</h2>

        <div class="settings-grid">
          <div class="settings-field">
            <label for="seed">Seed:</label>
            <input type="text" id="seed" maxlength="8" pattern="[A-Z1-9]{1,8}" class="settings-core-input" required />
          </div>

          <div class="settings-field">
            <label for="ante">Max Ante:</label>
            <input type="number" id="ante" min="1" max="39" class="settings-core-input" value="39" required />
          </div>

          <div class="settings-field">
            <label for="cardsPerAnte">Cards per Ante:</label>
            <input type="number" id="cardsPerAnte" min="0" value="300" class="settings-core-input" required />
          </div>

          <div class="settings-field">
            <label for="deck">Deck:</label>
            <select id="deck" required>
              <option value="Red Deck">Red Deck</option>
              <option value="Blue Deck">Blue Deck</option>
              <option value="Yellow Deck">Yellow Deck</option>
              <option value="Green Deck">Green Deck</option>
              <option value="Black Deck">Black Deck</option>
              <option value="Magic Deck">Magic Deck</option>
              <option value="Nebula Deck">Nebula Deck</option>
              <option value="Ghost Deck">Ghost Deck</option>
              <option value="Abandoned Deck">Abandoned Deck</option>
              <option value="Checkered Deck">Checkered Deck</option>
              <option value="Zodiac Deck">Zodiac Deck</option>
              <option value="Painted Deck">Painted Deck</option>
              <option value="Anaglyph Deck">Anaglyph Deck</option>
              <option value="Plasma Deck" selected>Plasma Deck</option>
              <option value="Erratic Deck">Erratic Deck</option>
            </select>
          </div>

          <div class="settings-field">
            <label for="stake">Stake:</label>
            <select id="stake" required>
              <option value="White Stake">White Stake</option>
              <option value="Red Stake">Red Stake</option>
              <option value="Green Stake">Green Stake</option>
              <option value="Black Stake">Black Stake</option>
              <option value="Blue Stake">Blue Stake</option>
              <option value="Purple Stake">Purple Stake</option>
              <option value="Orange Stake">Orange Stake</option>
              <option value="Gold Stake">Gold Stake</option>
            </select>
          </div>

          <div class="settings-field">
            <label for="version">Version:</label>
            <select id="version" required>
              <option value="10115">1.0.1o-full</option>
              <option value="10014">1.0.0n</option>
              <option value="10106">1.0.1f</option>
              <option value="10103">1.0.1c</option>
            </select>
          </div>
        </div>

        <div class="checkbox-row">
          <input type="checkbox" id="omitBeforeAnte9" checked />
          <label for="omitBeforeAnte9">Omit results before Ante 9</label>
        </div>
        <div class="settings-actions">
          <button id="analyzeButton">Analyze</button>
          <button id="openCheckboxesBtn">Modify Unlocks</button>
          <button id="copyButton">Copy Link</button>
          <button id="downloadButton">Download output</button>
        </div>

        <div id="checkboxesOverlay">
          <div id="checkboxesPopup">
            <h2>Unlocked Items</h2>
            <div id="checkboxesContainer"></div>
            <div class="unlock-actions">
              <button id="submitBtn">Submit</button>
              <button id="unlockBtn">Unlock All</button>
              <button id="lockBtn">Lock All</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="summaryFloatingWindow">
      <div id="summaryFloatingContent" aria-live="polite"></div>
    </div>
    <div id="summaryFilterWindow">
      <div id="summaryFilterContent"></div>
    </div>
    <div id="searchFloatingWindow"></div>
    <div id="emojiLegendWindow">
      <div id="emojiLegendContent"></div>
    </div>
    <div id="summaryButtons">
      <button id="searchFloatingToggle" type="button" aria-label="Search">üîç</button>
      <button id="summaryFloatingToggle" type="button">Summary</button>
      <button id="summaryFilterToggle" type="button">Settings</button>
    </div>
    <button id="scrollToTopButton" type="button" aria-label="Back to top">‚Üë</button>
  </body>
</html>
